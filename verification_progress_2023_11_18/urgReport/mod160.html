<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta name="Author" content="<username>"> <meta name="GENERATOR" content="urg/version [en] (platform name) [urg]">
<title>Unified Coverage Report :: Module :: CTU_CAN_FD_TB.TB_RANDOM_PKG</title>
<link type="text/css" rel="stylesheet" href="css/.urg.css">
<link type="text/css" rel="stylesheet" href="css/.layout.css">
<link type="text/css" rel="stylesheet" href="css/.breadcrumb.css">
<script type="text/javascript" src="js/.jquery.js"></script>
<script type="text/javascript" src="js/.jquery-ui.js"></script>
<script type="text/javascript" src="js/.sortable.js"></script>
<script type="text/javascript" src="js/.layout.js"></script>
<script type="text/javascript" src="js/.breadcrumb.js"></script>
<script type="text/javascript">
var layout, westLayout, centerLayout;
$(document).ready(function () {
  if ($("#north-bread-crumb")) {
    $("#north-bread-crumb").jBreadCrumb({easing:'swing'})
  }
  layout = $("body").layout({ 
    resizable: true,
    spacing_open: 4,
    spacing_closed: 4,
    north: {
      size: 76
    },
    south: {
      size: 45,
      initClosed: true
    },
    west: {
      size: 500,
      resizable: true,
      initClosed: false
    }
  });
  centerLayout = $('div.ui-layout-center').layout({
    north__paneSelector: ".ui-layout-center-inner-north",
    center__paneSelector: ".ui-layout-center-inner-center", 
    north__size: 50,
    spacing_open: 4,
    spacing_closed: 4
  });
});
</script>
</head>
<body onLoad="initPage();"><div class="ui-layout-north">
<div class="logo"></div>
<center class="pagetitle">Module Definition</center>
<div align="center"><a href="dashboard.html" ><b>dashboard</b></a> | <a href="hierarchy.html" ><b>hierarchy</b></a> | <a href="modlist.html" ><b>modlist</b></a> | groups | <a href="tests.html" ><b>tests</b></a> | <a href="asserts.html" ><b>asserts</b></a></div>

</div>
<div class="ui-layout-west">
<div name='tag_CTU_CAN_FD_TB.TB_RANDOM_PKG'>
<div class=modhdr>
<br clear=all>
<span class=titlename>Module : <a href="#"  onclick="showContent('tag_CTU_CAN_FD_TB.TB_RANDOM_PKG')">CTU_CAN_FD_TB.TB_RANDOM_PKG</a></span>
<br clear=all>
<table align=left>
<tr class="sortablehead">
<td>SCORE</td><td>LINE</td><td>COND</td><td>TOGGLE</td><td>FSM</td><td>BRANCH</td><td>ASSERT</td></tr><tr>
<td class="s1 cl rt"> 19.63</td>
<td class="s1 cl rt"><a href="mod160.html#Line" > 19.63</a></td>
<td class="wht cl rt"></td>
<td class="wht cl rt"></td>
<td class="wht cl rt"></td>
<td class="wht cl rt"></td>
<td class="wht cl rt"></td>
</tr></table><br clear=all>
<span class=repname>Source File(s) : </span>
<br clear=all>
<a href="javascript:void(0);"  onclick="openSrcFile('/home/oille/Downloads/ctucanfd_ip_core/test/main_tb/pkg/tb_random_pkg.vhd')">/home/oille/Downloads/ctucanfd_ip_core/test/main_tb/pkg/tb_random_pkg.vhd</a><br clear=all>
<br clear=all>
<span class=repname>Module self-instances :</span>
<br clear=all>
<table align=left>
<tr class="sortablehead">
<td class="alfsrt">NAME</td><td>SCORE</td><td>LINE</td><td>COND</td><td>TOGGLE</td><td>FSM</td><td>BRANCH</td><td>ASSERT</td></tr></table></div>
</div>
<br clear=all>
</div>
<div class="ui-layout-center">
<div class="ui-layout-center-inner-center">
<div name='tag_CTU_CAN_FD_TB.TB_RANDOM_PKG'>
<a name="Line"></a>
Line Coverage for Module : <a href="mod160.html" >CTU_CAN_FD_TB.TB_RANDOM_PKG</a><br clear=all>
<table class="noborder">
<col width="122">
<col span="4" width="82">
<tr><th></th><th>Line No.</th><th>Total</th><th>Covered</th><th>Percent</th></tr>
<tr class="s1"><td class="lf">TOTAL</td><td></td><td>107</td><td>21</td><td>19.63</td></tr>
<tr class="s10"><td class="lf">VHDL_FUNCTION</td><td>1206</td><td>1</td><td>1</td><td>100.00</td></tr>
<tr class="s10"><td class="lf">VHDL_PROCEDURE</td><td>1213</td><td>1</td><td>1</td><td>100.00</td></tr>
<tr class="s10"><td class="lf">VHDL_PROCEDURE</td><td>1218</td><td>1</td><td>1</td><td>100.00</td></tr>
<tr class="s10"><td class="lf">VHDL_PROCEDURE</td><td>1230</td><td>2</td><td>2</td><td>100.00</td></tr>
<tr class="s0"><td class="lf">VHDL_FUNCTION</td><td>1240</td><td>3</td><td>0</td><td>0.00</td></tr>
<tr class="s0"><td class="lf">VHDL_PROCEDURE</td><td>1251</td><td>4</td><td>0</td><td>0.00</td></tr>
<tr class="s10"><td class="lf">VHDL_PROCEDURE</td><td>1264</td><td>2</td><td>2</td><td>100.00</td></tr>
<tr class="s0"><td class="lf">VHDL_PROCEDURE</td><td>1277</td><td>5</td><td>0</td><td>0.00</td></tr>
<tr class="s10"><td class="lf">VHDL_PROCEDURE</td><td>1294</td><td>3</td><td>3</td><td>100.00</td></tr>
<tr class="s0"><td class="lf">VHDL_PROCEDURE</td><td>1307</td><td>6</td><td>0</td><td>0.00</td></tr>
<tr class="s10"><td class="lf">VHDL_PROCEDURE</td><td>1326</td><td>5</td><td>5</td><td>100.00</td></tr>
<tr class="s0"><td class="lf">VHDL_PROCEDURE</td><td>1344</td><td>8</td><td>0</td><td>0.00</td></tr>
<tr class="s10"><td class="lf">VHDL_PROCEDURE</td><td>1366</td><td>6</td><td>6</td><td>100.00</td></tr>
<tr class="s0"><td class="lf">VHDL_PROCEDURE</td><td>1388</td><td>9</td><td>0</td><td>0.00</td></tr>
<tr class="s0"><td class="lf">VHDL_PROCEDURE</td><td>1414</td><td>8</td><td>0</td><td>0.00</td></tr>
<tr class="s0"><td class="lf">VHDL_PROCEDURE</td><td>1438</td><td>10</td><td>0</td><td>0.00</td></tr>
<tr class="s0"><td class="lf">VHDL_PROCEDURE</td><td>1467</td><td>6</td><td>0</td><td>0.00</td></tr>
<tr class="s0"><td class="lf">VHDL_PROCEDURE</td><td>1487</td><td>8</td><td>0</td><td>0.00</td></tr>
<tr class="s0"><td class="lf">VHDL_PROCEDURE</td><td>1515</td><td>11</td><td>0</td><td>0.00</td></tr>
<tr class="s0"><td class="lf">VHDL_PROCEDURE</td><td>1548</td><td>3</td><td>0</td><td>0.00</td></tr>
<tr class="s0"><td class="lf">VHDL_PROCEDURE</td><td>1560</td><td>5</td><td>0</td><td>0.00</td></tr>
</table>
<pre class="code"><br clear=all>
1205                            begin
1206       1/1                      return counter;
1207                            end function;
1208                    
1209                            procedure set(
1210                                value         : in    natural range 0 to RAND_POOL_SIZE
1211                            ) is
1212                            begin
1213       1/1                      counter := value;
1214                            end procedure;
1215                    
1216                            procedure increment is
1217                            begin
1218       1/1                      counter := (counter + 1) mod RAND_POOL_SIZE;
1219                            end procedure;
1220                    
1221                        end protected body;
1222                    
1223                    	shared variable rand_ctr : t_rand_ctr;
1224                    
1225                    
1226                        procedure apply_rand_seed(
1227                            constant seed            : in   natural
1228                        ) is
1229                        begin
1230       1/1                  info_m(&quot;Random initialized with seed &quot; &amp; natural'image(seed));
1231       1/1                  rand_ctr.set(seed mod RAND_POOL_SIZE);
1232                        end procedure;
1233                    
1234                    
1235                        -- variation of above, only returns the seed value
1236                        impure function apply_rand_seed(
1237                            constant seed            : in   natural
1238                        ) return natural is
1239                        begin
1240       <font color = "red">0/1     ==>          info_m(&quot;Random initialized with seed &quot; &amp; natural'image(seed));</font>
1241       <font color = "red">0/1     ==>          rand_ctr.set(seed);</font>
1242       <font color = "red">0/1     ==>          return seed;</font>
1243                        end function;
1244                    
1245                    
1246                        procedure rand_real_s(
1247                            signal   retval           : out   real;
1248                            constant refresh          : in    boolean := true
1249                        ) is
1250                        begin
1251       <font color = "red">0/1     ==>          rand_ctr.increment;</font>
1252                    
1253       <font color = "red">0/1     ==>          retVal &lt;= randomLibData(rand_ctr.get);</font>
1254       <font color = "red">0/1     ==>          if (refresh) then</font>
1255       <font color = "red">0/1     ==>              wait for 0 ns;</font>
1256                            end if;
1257                        end procedure;
1258                    
1259                    
1260                        procedure rand_real_v(
1261                            variable retval         : out   real
1262                        ) is
1263                        begin
1264       1/1                  rand_ctr.increment;
1265                    
1266       1/1                  retVal := randomLibData(rand_ctr.get);
1267                        end procedure;
1268                    
1269                    
1270                        procedure rand_int_s(
1271                            constant max            : in    natural;
1272                            signal   retval         : out   natural;
1273                            constant refresh        : in    boolean := true
1274                        )is
1275                            variable tmp            :       real;
1276                        begin
1277       <font color = "red">0/1     ==>          rand_ctr.increment;</font>
1278                    
1279       <font color = "red">0/1     ==>          tmp := randomLibData(rand_ctr.get);</font>
1280       <font color = "red">0/1     ==>          retval &lt;= natural(tmp * real(max));</font>
1281                    
1282       <font color = "red">0/1     ==>          if (refresh) then</font>
1283       <font color = "red">0/1     ==>              wait for 0 ns;</font>
1284                            end if;
1285                        end procedure;
1286                    
1287                    
1288                        procedure rand_int_v(
1289                            constant max            : in    natural;
1290                            variable retval         : out   natural
1291                        ) is
1292                            variable tmp            :       real;
1293                        begin
1294       1/1                  rand_ctr.increment;
1295                    
1296       1/1                  tmp := randomLibData(rand_ctr.get);
1297       1/1                  retval := natural(tmp * real(max));
1298                        end procedure;
1299                    
1300                    
1301                        procedure rand_logic_s(
1302                            signal   retval         : out 	std_logic;
1303                            constant chances        : in 	real;
1304                            constant refresh        : in    boolean := true
1305                        )is
1306                        begin
1307       <font color = "red">0/1     ==>          rand_ctr.increment;</font>
1308                    
1309       <font color = "red">0/1     ==>          if (randomLibData(rand_ctr.get) &lt; chances) then</font>
1310       <font color = "red">0/1     ==>              retVal &lt;= '1';</font>
1311                            else
1312       <font color = "red">0/1     ==>              retVal &lt;= '0';</font>
1313                            end if;
1314                    
1315       <font color = "red">0/1     ==>          if (refresh) then</font>
1316       <font color = "red">0/1     ==>              wait for 0 ns;</font>
1317                            end if;
1318                        end procedure;
1319                    
1320                    
1321                        procedure rand_logic_v(
1322                            variable retval         : out   std_logic;
1323                            constant chances        : in    real
1324                        ) is
1325                        begin
1326       1/1                  rand_ctr.increment;
1327       1/1                  wait for 0 ns;
1328                    
1329       1/1                  if (randomLibData(rand_ctr.get) &lt; chances) then
1330       1/1                      retVal := '1';
1331                            else
1332       1/1                      retVal := '0';
1333                            end if;
1334                        end procedure;
1335                    
1336                    
1337                    
1338                        procedure rand_logic_vect_s(
1339                            signal   retVal         : out   std_logic_vector;
1340                            constant chances        : in    real;
1341                            constant refresh        : in    boolean := true
1342                        ) is
1343                        begin
1344       <font color = "red">0/1     ==>          for i in 0 to retVal'length - 1 loop</font>
1345       <font color = "red">0/1     ==>              rand_ctr.increment;</font>
1346       <font color = "red">0/1     ==>              wait for 0 ns;</font>
1347                    
1348       <font color = "red">0/1     ==>              if (randomLibData(rand_ctr.get) &lt; chances) then</font>
1349       <font color = "red">0/1     ==>                  retVal(i) &lt;= '1';</font>
1350                                else
1351       <font color = "red">0/1     ==>                  retVal(i) &lt;= '0';</font>
1352                                end if;
1353                            end loop;
1354                    
1355       <font color = "red">0/1     ==>          if (refresh) then</font>
1356       <font color = "red">0/1     ==>              wait for 0 ns;</font>
1357                            end if;
1358                        end procedure;
1359                    
1360                    
1361                        procedure rand_logic_vect_v(
1362                            variable retVal         : out   std_logic_vector;
1363                            constant chances        : in    real
1364                        ) is
1365                        begin
1366       1/1                  for i in 0 to retVal'length - 1 loop
1367       1/1                      rand_ctr.increment;
1368                    
1369       1/1                      wait for 0 ns;
1370                    
1371       1/1                      if (randomLibData(rand_ctr.get) &lt; chances) then
1372       1/1                          retVal(i) := '1';
1373                                else
1374       1/1                          retVal(i) := '0';
1375                                end if;
1376                    
1377                            end loop;
1378                        end procedure;
1379                    
1380                    
1381                        procedure rand_logic_vect_cons_s(
1382                            signal   retVal         : inout std_logic_vector;
1383                            constant cons_chance    : in    real
1384                        ) is
1385                            variable tmp            :       std_logic;
1386                            variable tmp_real       :       real;
1387                        begin
1388       <font color = "red">0/1     ==>          rand_logic_v(tmp, 0.5);</font>
1389       <font color = "red">0/1     ==>          retVal(0) &lt;= tmp;</font>
1390                    
1391       <font color = "red">0/1     ==>          for i in 1 to retVal'length - 1 loop</font>
1392                    
1393                                -- Swap value with &quot;p(1 - cons_chance)&quot;
1394       <font color = "red">0/1     ==>              rand_real_v(tmp_real);</font>
1395       <font color = "red">0/1     ==>              wait for 0 ns;</font>
1396       <font color = "red">0/1     ==>              if (tmp_real &gt; cons_chance) then</font>
1397       <font color = "red">0/1     ==>                  tmp := not tmp;</font>
1398                                end if;
1399                    
1400       <font color = "red">0/1     ==>              retVal(i) &lt;= tmp;</font>
1401                            end loop;
1402                    
1403       <font color = "red">0/1     ==>          wait for 0 ns;</font>
1404                        end procedure;
1405                    
1406                    
1407                        procedure rand_logic_vect_cons_v(
1408                            variable retVal         : inout std_logic_vector;
1409                            constant cons_chance    : in    real
1410                        ) is
1411                            variable tmp            :       std_logic;
1412                            variable tmp_real       :       real;
1413                        begin
1414       <font color = "red">0/1     ==>          rand_logic_v(tmp, 0.5);</font>
1415       <font color = "red">0/1     ==>          retVal(0) := tmp;</font>
1416                    
1417       <font color = "red">0/1     ==>          for i in 1 to retVal'length - 1 loop</font>
1418                    
1419                                -- Swap value with &quot;p(1 - cons_chance)&quot;
1420       <font color = "red">0/1     ==>              rand_real_v(tmp_real);</font>
1421       <font color = "red">0/1     ==>              wait for 0 ns;</font>
1422       <font color = "red">0/1     ==>              if (tmp_real &gt; cons_chance) then</font>
1423       <font color = "red">0/1     ==>                  tmp := not tmp;</font>
1424                                end if;
1425                    
1426       <font color = "red">0/1     ==>              retVal(i) := tmp;</font>
1427                            end loop;
1428                        end procedure;
1429                    
1430                    
1431                        procedure rand_logic_vect_bt_s(
1432                            signal   retVal         : inout std_logic_vector;
1433                            constant bt             : in    integer;
1434                            constant chances        : in    real;
1435                            constant refresh        : in    boolean := true
1436                        )is
1437                        begin
1438       <font color = "red">0/1     ==>          for i in 0 to retVal'length - 1 loop</font>
1439       <font color = "red">0/1     ==>              rand_ctr.increment;</font>
1440       <font color = "red">0/1     ==>              wait for 0 ns;</font>
1441                    
1442       <font color = "red">0/1     ==>              if (randomLibData(rand_ctr.get) &lt; chances) then</font>
1443       <font color = "red">0/1     ==>                  retVal(i) &lt;= '1';</font>
1444                                else
1445       <font color = "red">0/1     ==>                  retVal(i) &lt;= '0';</font>
1446                                end if;
1447                    
1448                            end loop;
1449                    
1450       <font color = "red">0/1     ==>          if (unsigned(retVal) &lt;= bt) then</font>
1451       <font color = "red">0/1     ==>            retval &lt;= std_logic_vector(to_unsigned(bt + 1, retval'length));</font>
1452                            end if;
1453                    
1454       <font color = "red">0/1     ==>          if (refresh) then</font>
1455       <font color = "red">0/1     ==>              wait for 0 ns;</font>
1456                            end if;
1457                        end procedure;
1458                    
1459                    
1460                        procedure wait_rand_cycles(
1461                            signal   clk            : in    std_logic;
1462                            constant min            : in    integer;
1463                            constant max            : in    integer
1464                        )is
1465                            variable rand_val       :       natural;
1466                        begin
1467       <font color = "red">0/1     ==>          if (max &lt; min) then</font>
1468       <font color = "red">0/1     ==>              report &quot;Invalid input parameters, MAX lower than MIN&quot; severity</font>
1469                                error;
1470                            else
1471       <font color = "red">0/1     ==>              rand_int_v(max - min, rand_val);</font>
1472       <font color = "red">0/1     ==>              rand_val := rand_val + min;</font>
1473                    
1474       <font color = "red">0/1     ==>              for i in 0 to rand_val loop</font>
1475       <font color = "red">0/1     ==>                  wait until rising_edge(clk);</font>
1476                                end loop;
1477                            end if;
1478                        end procedure;
1479                    
1480                    
1481                        procedure rand_logic_vect_bt_v(
1482                            variable retVal         : inout std_logic_vector;
1483                            constant bt             : in    integer;
1484                            constant chances        : in    real
1485                        )is
1486                        begin
1487       <font color = "red">0/1     ==>          for i in 0 to retVal'length - 1 loop</font>
1488                    
1489       <font color = "red">0/1     ==>              rand_ctr.increment;</font>
1490       <font color = "red">0/1     ==>              wait for 0 ns;</font>
1491                    
1492       <font color = "red">0/1     ==>              if (randomLibData(rand_ctr.get) &lt; chances) then</font>
1493       <font color = "red">0/1     ==>                  retVal(i) := '1';</font>
1494                                else
1495       <font color = "red">0/1     ==>                  retVal(i) := '0';</font>
1496                                end if;
1497                    
1498                            end loop;
1499                    
1500       <font color = "red">0/1     ==>          if (unsigned(retVal) &lt;= bt) then</font>
1501       <font color = "red">0/1     ==>            retval := std_logic_vector(to_unsigned(bt + 1, retval'length));</font>
1502                            end if;
1503                        end procedure;
1504                    
1505                    
1506                        procedure rand_gauss(
1507                            constant iter_amount       : in    natural;
1508                            constant mean              : in    real;
1509                            constant variance          : in    real;
1510                            variable retVal            : out   real
1511                        ) is
1512                            variable accum             :       real := 0.0;
1513                            variable aux               :       real;
1514                        begin
1515       <font color = "red">0/1     ==>          accum := 0.0;</font>
1516                    
1517                            -- Sum up &quot;iter_amount&quot; numbers which have uniform distribution
1518                            -- from (0,1) interval with 1/12 variance.
1519       <font color = "red">0/1     ==>          for i in 0 to iter_amount - 1 loop</font>
1520       <font color = "red">0/1     ==>              rand_real_v(aux);</font>
1521       <font color = "red">0/1     ==>              accum := accum + aux;</font>
1522                            end loop;
1523                    
1524                            -- Now accum has mean equal to iter_amount/2. Variance is now
1525                            -- &quot;sqrt(1/12) / iter_amount&quot;. Transform it to mean equal zero.
1526       <font color = "red">0/1     ==>          accum := accum - (real(iter_amount) / 2.0);</font>
1527       <font color = "red">0/1     ==>          accum := accum / SQRT (real(iter_amount) / 12.0);</font>
1528                    
1529                            -- Now we have standard normal distribution we just scale it to the
1530                            -- given mean and variance.
1531       <font color = "red">0/1     ==>          accum := accum * variance;</font>
1532       <font color = "red">0/1     ==>          accum := accum + mean;</font>
1533                    
1534       <font color = "red">0/1     ==>          if (accum &lt; 0.0) then</font>
1535       <font color = "red">0/1     ==>              accum   := 0.0;</font>
1536                            end if;
1537       <font color = "red">0/1     ==>          retVal      := accum;</font>
1538                        end procedure;
1539                    
1540                    
1541                        procedure rand_exponential(
1542                            constant scale              : in    real;
1543                            variable retVal             : out   real
1544                        ) is
1545                            variable scale_pos          :       real;
1546                            variable tmp                :       real;
1547                        begin
1548       <font color = "red">0/1     ==>          scale_pos := scale * (-1.0);</font>
1549       <font color = "red">0/1     ==>          rand_real_v(tmp);</font>
1550       <font color = "red">0/1     ==>          retVal := scale_pos *  LOG (tmp);</font>
1551                        end procedure;
1552                    
1553                    
1554                        procedure rand_real_distr_v(
1555                            variable retVal             : out   real;
1556                            constant distribution	    : in	rand_distribution_type;
1557                            constant parameters		    : in 	rand_distribution_par_type
1558                        ) is
1559                        begin
1560       <font color = "red">0/1     ==>          case distribution is</font>
1561                    
1562                            when GAUSS =&gt;
1563       <font color = "red">0/1     ==>              rand_gauss(integer(parameters(GAUSS_iterations)),</font>
1564                                           parameters(GAUSS_mean),
1565                                           parameters(GAUSS_variance),
1566                                           retVal);
1567                    
1568                            when EXPONENTIAL =&gt;
1569       <font color = "red">0/1     ==>              rand_exponential(parameters(EXPONENTIAL_mean), retVal);</font>
1570                    
1571                            when others =&gt;
1572       <font color = "red">0/1     ==>              report &quot;Unsupported probability distribution&quot; severity warning;</font>
1573       <font color = "red">0/1     ==>              retVal := 0.0;</font>
</pre>
</div>
</div>
<div class="ui-layout-center-inner-north">
<div id="center-bread-crumb" class="breadCrumb module urg-margin-bottom">
  <ul name="tag_CTU_CAN_FD_TB.TB_RANDOM_PKG">
    <li>
      <a href="#Line">Line</a>    </li>
  </ul>
</div>
</div>
</div>
<div class="ui-layout-south">
<table align=center><tr><td class="s0 cl">0%</td>
<td class="s1 cl">10%</td>
<td class="s2 cl">20%</td>
<td class="s3 cl">30%</td>
<td class="s4 cl">40%</td>
<td class="s5 cl">50%</td>
<td class="s6 cl">60%</td>
<td class="s7 cl">70%</td>
<td class="s8 cl">80%</td>
<td class="s9 cl">90%</td>
<td class="s10 cl">100%</td></tr></table></div>
</body>
</html>
